{
  "01_qualification_required": {
    "case": {
      "arguments": "--source a=a.ndjson --source b=b.ndjson --query \"SELECT service FROM a CONFLATE INTERSECTING b UPON a.req = b.req\"",
      "input_files": [
        {
          "path": "b.ndjson",
          "content": [
            {
              "edge_id": "e1",
              "req": "r1"
            }
          ],
          "file_type": "jsonl"
        },
        {
          "path": "a.ndjson",
          "content": [
            {
              "id": 1,
              "service": "api",
              "req": "r1"
            }
          ],
          "file_type": "jsonl"
        }
      ]
    },
    "expected": {
      "stderr": {
        "error": ".*E_SEMANTIC.*",
        "code": "E_SEMANTIC"
      },
      "status_code": 1
    }
  },
  "02_select_star_forbidden": {
    "case": {
      "arguments": "--source a=a.ndjson --source b=b.ndjson --query \"SELECT * FROM a CONFLATE INTERSECTING b UPON a.req = b.req\"",
      "input_files": [
        {
          "path": "b.ndjson",
          "content": [
            {
              "edge_id": "e1",
              "req": "r1"
            }
          ],
          "file_type": "jsonl"
        },
        {
          "path": "a.ndjson",
          "content": [
            {
              "id": 1,
              "req": "r1"
            }
          ],
          "file_type": "jsonl"
        }
      ]
    },
    "expected": {
      "stderr": {
        "error": ".*E_SEMANTIC.*",
        "code": "E_SEMANTIC"
      },
      "status_code": 1
    }
  },
  "03_same_alias_in_upon": {
    "case": {
      "arguments": "--source a=a.ndjson --source b=b.ndjson --query \"SELECT a.id FROM a CONFLATE INTERSECTING b UPON a.req = a.req\"",
      "input_files": [
        {
          "path": "b.ndjson",
          "content": [
            {
              "edge_id": "e1",
              "req": "r1"
            }
          ],
          "file_type": "jsonl"
        },
        {
          "path": "a.ndjson",
          "content": [
            {
              "id": 1,
              "req": "r1"
            }
          ],
          "file_type": "jsonl"
        }
      ]
    },
    "expected": {
      "stderr": {
        "error": ".*E_SEMANTIC.*",
        "code": "E_SEMANTIC"
      },
      "status_code": 1
    }
  },
  "04_conflicting_bindings": {
    "case": {
      "arguments": "--source a=one.ndjson --source a=two.ndjson --query \"SELECT a.id FROM a\"",
      "input_files": []
    },
    "expected": {
      "stderr": {
        "error": ".*E_SEMANTIC.*",
        "code": "E_SEMANTIC"
      },
      "status_code": 1
    }
  }
}