{
  "01_bad_operator_parse_error": {
    "case": {
      "arguments": "--log-file logs.ndjson --query \"SELECT level FROM logs WHERE level ~ \\\"ERR\\\"\"",
      "input_files": [
        {
          "path": "logs.ndjson",
          "content": [
            {
              "level": "INFO",
              "message": "ok"
            }
          ],
          "file_type": "jsonl"
        }
      ]
    },
    "expected": {
      "stderr": {
        "error": ".*~.*",
        "code": "E_PARSE"
      },
      "status_code": 1
    }
  },
  "02_wrong_table_name": {
    "case": {
      "arguments": "--log-file logs.ndjson --query \"SELECT level FROM events\"",
      "input_files": [
        {
          "path": "logs.ndjson",
          "content": [
            {
              "level": "INFO"
            }
          ],
          "file_type": "jsonl"
        }
      ]
    },
    "expected": {
      "stderr": {
        "error": ".*logs.*",
        "code": "E_SEMANTIC"
      },
      "status_code": 1
    }
  },
  "03_duplicate_select_field": {
    "case": {
      "arguments": "--log-file logs.ndjson --query \"SELECT level, level FROM logs\"",
      "input_files": [
        {
          "path": "logs.ndjson",
          "content": [
            {
              "level": "INFO"
            }
          ],
          "file_type": "jsonl"
        }
      ]
    },
    "expected": {
      "stderr": {
        "error": ".*level.*",
        "code": "E_SEMANTIC"
      },
      "status_code": 1
    }
  },
  "04_missing_file_io_error": {
    "case": {
      "arguments": "--log-file missing.ndjson --query \"SELECT * FROM logs\"",
      "input_files": []
    },
    "expected": {
      "stderr": {
        "error": ".*missing\\.ndjson.*",
        "code": "E_IO"
      },
      "status_code": 1
    }
  },
  "05_malformed_ndjson_runtime_error": {
    "case": {
      "arguments": "--log-file logs.ndjson --query \"SELECT * FROM logs\"",
      "input_files": [
        {
          "path": "logs.ndjson",
          "content": "{\"ok\": 1}\n{not valid json}\n{\"ok\": 2}",
          "file_type": "text"
        }
      ]
    },
    "expected": {
      "stderr": {
        "error": ".*E_RUNTIME.*",
        "code": "E_RUNTIME"
      },
      "status_code": 1
    }
  }
}