{
  "01_scalar_pocket_cardinality_error": {
    "case": {
      "arguments": "--source a=a.ndjson --source b=b.ndjson --query \"SELECT POCKET(SELECT b.rid FROM b WHERE b.status >= 200) AS r FROM a WHERE a.id = 1\"",
      "input_files": [
        {
          "path": "b.ndjson",
          "content": [
            {
              "rid": "r1",
              "status": 200
            },
            {
              "rid": "r2",
              "status": 201
            }
          ],
          "file_type": "jsonl"
        },
        {
          "path": "a.ndjson",
          "content": [
            {
              "id": 1
            }
          ],
          "file_type": "jsonl"
        }
      ]
    },
    "expected": {
      "stderr": {
        "error": ".*E_SEMANTIC.*",
        "code": "E_SEMANTIC"
      },
      "status_code": 1
    }
  },
  "02_bad_uptree_alias": {
    "case": {
      "arguments": "--source a=a.ndjson --source b=b.ndjson --query \"SELECT a.id, POCKET(SELECT COUNT(*) FROM b WHERE b.rid = UPTREE.z.req) AS n FROM a\"",
      "input_files": [
        {
          "path": "b.ndjson",
          "content": [
            {
              "rid": "r1"
            }
          ],
          "file_type": "jsonl"
        },
        {
          "path": "a.ndjson",
          "content": [
            {
              "id": 1,
              "req": "r1"
            }
          ],
          "file_type": "jsonl"
        }
      ]
    },
    "expected": {
      "stderr": {
        "error": ".*E_SEMANTIC.*",
        "code": "E_SEMANTIC"
      },
      "status_code": 1
    }
  },
  "03_table_pocket_column_count": {
    "case": {
      "arguments": "--source a=a.ndjson --source c=c.ndjson --query \"SELECT a.id FROM a WHERE a.route AMONGST POCKET[SELECT c.route, c.slo_ms FROM c]\"",
      "input_files": [
        {
          "path": "a.ndjson",
          "content": [
            {
              "id": 1,
              "route": "/a"
            }
          ],
          "file_type": "jsonl"
        },
        {
          "path": "c.ndjson",
          "content": [
            {
              "route": "/a",
              "slo_ms": 20
            },
            {
              "route": "/b",
              "slo_ms": 15
            }
          ],
          "file_type": "jsonl"
        }
      ]
    },
    "expected": {
      "stderr": {
        "error": ".*E_SEMANTIC.*",
        "code": "E_SEMANTIC"
      },
      "status_code": 1
    }
  },
  "04_missing_operator_before_eitherwise": {
    "case": {
      "arguments": "--source a=a.ndjson --source c=c.ndjson --query \"SELECT a.id FROM a WHERE a.bytes EITHERWISE POCKET[SELECT c.limit FROM c WHERE c.route = UPTREE.a.route]\"",
      "input_files": [
        {
          "path": "a.ndjson",
          "content": [
            {
              "id": 1,
              "route": "/a",
              "bytes": 10
            }
          ],
          "file_type": "jsonl"
        },
        {
          "path": "c.ndjson",
          "content": [
            {
              "route": "/a",
              "limit": 100
            }
          ],
          "file_type": "jsonl"
        }
      ]
    },
    "expected": {
      "stderr": {
        "error": ".*",
        "code": ""
      },
      "status_code": 1
    }
  }
}