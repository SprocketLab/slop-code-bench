case:
  body:
    up_to_step: 2
    status: in_progress
    branch: retry-with-tool-use
    model: gpt-x-pro-128k
    append:
      - role: assistant
        content: "New branch reasoning with tools"
        input_tokens: 18
        output_tokens: 64
        cost: 0.0072
      - role: environment
        content: "grader: improved"
        input_tokens: null
        output_tokens: null
        cost: null
  headers:
    content-type: application/json; charset=utf-8
    if-match: W/"3"
  id: fork_with_append
  method: POST
  path: /trajectories/{{store.create_in_progress_trajectory}}/fork
expected:
  output:
    properties:
      id:
        type: string
        pattern: '^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$'
      date:
        type: string
        pattern: '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$'
      task:
        const: cot_math_gsm8k
      environment:
        const: local-sim
      model:
        const: gpt-x-pro-128k
      framework:
        const: my-agent-v2
      status:
        const: in_progress
      rev:
        const: 1
      steps:
        const: 5
      final_output_tokens:
        const: 64
      final_cost:
        const: 0.0072
      created_at:
        type: string
        pattern: '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$'
      lineage:
        properties:
          parent_id:
            const: "{{store.create_in_progress_trajectory}}"
          parent_rev:
            const: 3
          forked_from_step:
            const: 2
          branch:
            const: retry-with-tool-use
        required:
        - parent_id
        - parent_rev
        - forked_from_step
        - branch
        type: object
    required:
    - id
    - date
    - task
    - environment
    - model
    - framework
    - status
    - rev
    - steps
    - final_output_tokens
    - final_cost
    - created_at
    - lineage
    type: object
  status_code: 201