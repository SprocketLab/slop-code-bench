case:
  body:
    up_to_step: 3
    status: in_progress
    append:
      - role: assistant
        content: First appended assistant
        input_tokens: 25
        output_tokens: 150
        cost: 0.015
      - role: user
        content: Another question
        input_tokens: null
        output_tokens: null
        cost: null
      - role: assistant
        content: Second assistant with LOWER totals than first
        input_tokens: 22
        output_tokens: 120
        cost: 0.012
  headers:
    content-type: application/json; charset=utf-8
    if-match: W/"1"
  id: fork_append_internal_total_violation
  method: POST
  path: /trajectories/{{store.hidden_create_for_running_totals}}/fork
expected:
  output:
    properties:
      error:
        properties:
          code:
            const: VALIDATION_FAILED
          message:
            type: string
          field_path:
            type: string
        required:
          - code
          - message
          - field_path
        type: object
    required:
      - error
    type: object
  status_code: 422
