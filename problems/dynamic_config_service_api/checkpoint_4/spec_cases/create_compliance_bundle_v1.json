{
  "case": {
    "body": {
      "metadata": {
        "version_label": "compliance-v1"
      },
      "rego_modules": {
        "compliance.rego": "package guardrails\n\ndeny[v] {\n  input.target.resolved_config.logging.level != \"debug\"\n  input.target.scope.env == \"prod\"\n  v := {\"id\":\"prod_debug_logging\",\"message\":\"Production must use debug logging\",\"path\":\"/logging/level\",\"target\": input.target.name}\n}\n\nwarn[v] {\n  input.target.resolved_config.metrics.enabled != true\n  v := {\"id\":\"metrics_disabled\",\"message\":\"Metrics collection should be enabled\",\"path\":\"/metrics/enabled\",\"target\": input.target.name}\n}\n"
      },
      "data": {
        "compliance": {
          "require_debug_logs_in_prod": true
        }
      }
    },
    "headers": {
      "content-type": "application/json; charset=utf-8"
    },
    "id": "create_compliance_bundle_v1",
    "method": "POST",
    "path": "/v1/policies/bundles/compliance-rules/versions"
  },
  "expected": {
    "output": {
      "properties": {
        "bundle_name": {
          "const": "compliance-rules"
        },
        "version": {
          "minimum": 1,
          "type": "integer"
        }
      },
      "required": [
        "bundle_name",
        "version"
      ],
      "type": "object"
    },
    "status_code": 201
  }
}
