case:
  arguments: --output out.csv --key id --schema schema.json --on-type-error coerce-null base.parquet extra.jsonl
  input_files:
  - content:
    - id: 1
      name: Alice
    - id: 2
      name: Bob
    file_type: parquet
    path: base.parquet
  - content:
    - id: 1
      attrs:
        country: US
        tier: 1
    - id: 2
      attrs: null
    file_type: jsonl
    path: extra.jsonl
  - content:
      columns:
      - name: id
        type: int
      - name: name
        type: string
      - name: attrs
        type:
          map:
            key: string
            value: string
    file_type: json
    path: schema.json
expected:
  files:
    out.csv:
    - id: 1
      name: Alice
      attrs: null
    - id: 1
      name: null
      attrs: '{"country":"US","tier":"1"}'
    - id: 2
      name: Bob
      attrs: null
    - id: 2
      name: null
      attrs: null
  status_code: 0
