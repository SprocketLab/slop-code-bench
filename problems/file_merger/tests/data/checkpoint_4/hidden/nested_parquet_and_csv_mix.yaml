case:
  arguments: --output out.csv --key user.id --schema schema.json users.parquet orders.csv products.jsonl
  input_files:
  - content:
    - user_id: 101
      user_name: Alice
    - user_id: 102
      user_name: Bob
    file_type: parquet
    path: users.parquet
  - content: 'order_id,user_id,total

      1,101,50.00

      2,102,75.50

      '
    file_type: text
    path: orders.csv
  - content:
    - order_id: 1
      items:
      - sku: "A1"
        qty: 2
      - sku: "B2"
        qty: 1
    - order_id: 2
      items:
      - sku: "C3"
        qty: 3
    file_type: jsonl
    path: products.jsonl
  - content:
      columns:
      - name: order_id
        type: int
      - name: user
        type:
          struct:
            fields:
            - name: id
              type: int
            - name: name
              type: string
      - name: total
        type: float
      - name: items
        type:
          array:
            element:
              struct:
                fields:
                - name: sku
                  type: string
                - name: qty
                  type: int
    file_type: json
    path: schema.json
expected:
  files:
    out.csv:
    - order_id: null
      user: null
      total: null
      items: null
    - order_id: null
      user: null
      total: null
      items: null
    - order_id: 1
      user: null
      total: 50.0
      items: null
    - order_id: 2
      user: null
      total: 75.5
      items: null
    - order_id: 1
      user: null
      total: null
      items: '[{"sku":"A1","qty":2},{"sku":"B2","qty":1}]'
    - order_id: 2
      user: null
      total: null
      items: '[{"sku":"C3","qty":3}]'
  status_code: 0
