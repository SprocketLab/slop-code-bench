{
  "arguments": "rules.json configs",
  "expected_stdout": "{\"event\":\"file_relocated\",\"from\":\"services/api/deploy/production.yaml\",\"to\":\"deployments/api-production.yaml\"}\\n{\"event\":\"file_relocated\",\"from\":\"services/api/deploy/staging.yaml\",\"to\":\"deployments/api-staging.yaml\"}\\n{\"event\":\"file_relocated\",\"from\":\"services/worker/deploy/production.yaml\",\"to\":\"deployments/worker-production.yaml\"}\\n{\"event\":\"file_relocated\",\"from\":\"services/worker/deploy/staging.yaml\",\"to\":\"deployments/worker-staging.yaml\"}\\n",
  "rules": {
    "flatten_deployments": {
      "type": "path_rename",
      "scope": "file",
      "path_pattern": "services/$name/deploy/$env.yaml",
      "new_path": "deployments/${name}-${env}.yaml"
    }
  },
  "expected_files": {
    "configs/deployments/api-production.yaml": "env: production\\nimage: api:production\\n",
    "configs/deployments/api-staging.yaml": "env: staging\\nimage: api:staging\\n",
    "configs/deployments/worker-production.yaml": "env: production\\nimage: worker:production\\n",
    "configs/deployments/worker-staging.yaml": "env: staging\\nimage: worker:staging\\n"
  }
}
