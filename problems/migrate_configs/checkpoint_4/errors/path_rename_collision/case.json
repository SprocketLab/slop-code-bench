{
  "arguments": "rules.json configs",
  "expected_stdout": "",
  "rules": {
    "flatten_structure": {
      "type": "path_rename",
      "scope": "file",
      "path_pattern": "services/*/deploy/$env.yaml",
      "new_path": "deployments/${env}.yaml"
    }
  },
  "status_code": 1,
  "expected_stderr": "^Error: destination already exists: deployments/production\\.yaml$",
  "files": {
    "configs/services/api/deploy/staging.yaml": "env: staging\nimage: api:staging\n",
    "configs/services/api/deploy/production.yaml": "env: production\nimage: api:prod\n",
    "configs/services/worker/deploy/staging.yaml": "env: staging\nimage: worker:staging\n",
    "configs/services/worker/deploy/production.yaml": "env: production\nimage: worker:prod\n"
  }
}
