{
    "bad_expr_parse": {
        "stdin": {
            "pipeline": {
                "steps": [
                    {
                        "op": "map",
                        "as": "bad",
                        "expr": "price ** qty"
                    },
                    {
                        "op": "map",
                        "as": "unit",
                        "expr": "price / qty"
                    }
                ]
            },
            "dataset": [
                {
                    "price": 10,
                    "qty": 0
                }
            ]
        },
        "expected": {
            "status": "error",
            "error_code": "BAD_EXPR",
            "message": "ETL_ERROR:.*",
            "path": "pipeline.steps[0].expr"
        }
    },
    "rename_missing_source": {
        "stdin": {
            "pipeline": {
                "steps": [
                    {
                        "op": "rename",
                        "mapping": {
                            "cost": "price"
                        }
                    }
                ]
            },
            "dataset": [
                {
                    "id": 1,
                    "price": 10
                }
            ]
        },
        "expected": {
            "status": "error",
            "error_code": "MISSING_COLUMN",
            "message": "ETL_ERROR:.*",
            "path": "pipeline.steps[0].mapping.cost"
        }
    },
    "select_missing_column": {
        "stdin": {
            "pipeline": {
                "steps": [
                    {
                        "op": "select",
                        "columns": [
                            "id",
                            "price",
                            "missing"
                        ]
                    }
                ]
            },
            "dataset": [
                {
                    "id": 1,
                    "price": 9.5
                }
            ]
        },
        "expected": {
            "status": "error",
            "error_code": "MISSING_COLUMN",
            "message": "ETL_ERROR:.*",
            "path": "pipeline.steps[0].columns[2]"
        }
    }
}