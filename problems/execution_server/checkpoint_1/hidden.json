{
  "initial_stats_hidden": {
    "order": 0,
    "input": {
      "method": "GET",
      "path": "/v1/stats/execution"
    },
    "expected": {
      "status_code": 200,
      "output": {
        "duration": {
          "average": null,
          "max": null,
          "median": null,
          "min": null,
          "stddev": null
        },
        "ran": 0
      }
    }
  },
  "stdin_string_stream": {
    "order": 1,
    "input": {
      "method": "POST",
      "path": "/v1/execute",
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "body": {
        "command": "cat",
        "env": {},
        "files": {},
        "stdin": "Line one\nLine two\n",
        "timeout": 10
      }
    },
    "expected": {
      "status_code": 201,
      "output": {
        "duration": 10,
        "exit_code": 0,
        "id": "UUID",
        "stderr": "",
        "stdout": "Line one\nLine two\n",
        "timed_out": false
      }
    }
  },
  "nonzero_exit_with_stderr": {
    "order": 2,
    "input": {
      "method": "POST",
      "path": "/v1/execute",
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "body": {
        "command": "sh -c \"echo 'processing complete'; echo 'some warning' 1>&2; exit 3\"",
        "env": {},
        "files": {},
        "stdin": [],
        "timeout": 10
      }
    },
    "expected": {
      "status_code": 201,
      "output": {
        "duration": 10,
        "exit_code": 3,
        "id": "UUID",
        "stderr": "some warning\n",
        "stdout": "processing complete\n",
        "timed_out": false
      }
    }
  },
  "nested_file_execution": {
    "order": 3,
    "input": {
      "method": "POST",
      "path": "/v1/execute",
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "body": {
        "command": "sh scripts/run.sh",
        "env": {},
        "files": {
          "inputs/city.txt": "Madison\n",
          "inputs/state.txt": "Wisconsin\n",
          "scripts/run.sh": "cat inputs/city.txt\ncat inputs/state.txt\n"
        },
        "stdin": [],
        "timeout": 10
      }
    },
    "expected": {
      "status_code": 201,
      "output": {
        "duration": 10,
        "exit_code": 0,
        "id": "UUID",
        "stderr": "",
        "stdout": "Madison\nWisconsin\n",
        "timed_out": false
      }
    }
  },
  "env_multiline_values": {
    "order": 4,
    "input": {
      "method": "POST",
      "path": "/v1/execute",
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "body": {
        "command": "sh -c \"printf '%s\\n' \\\"$GREETING\\\"; printf '%s\\n' \\\"$MULTILINE\\\"\"",
        "env": {
          "GREETING": "Hello there",
          "MULTILINE": "LineA\nLineB"
        },
        "files": {},
        "stdin": [],
        "timeout": 10
      }
    },
    "expected": {
      "status_code": 201,
      "output": {
        "duration": 10,
        "exit_code": 0,
        "id": "UUID",
        "stderr": "",
        "stdout": "Hello there\nLineA\nLineB\n",
        "timed_out": false
      }
    }
  },
  "stdout_without_newline": {
    "order": 5,
    "input": {
      "method": "POST",
      "path": "/v1/execute",
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "body": {
        "command": "printf 'READY'",
        "env": {},
        "files": {},
        "stdin": [],
        "timeout": 10
      }
    },
    "expected": {
      "status_code": 201,
      "output": {
        "duration": 10,
        "exit_code": 0,
        "id": "UUID",
        "stderr": "",
        "stdout": "READY",
        "timed_out": false
      }
    }
  },
  "default_timeout_and_empty_stdin": {
    "order": 6,
    "input": {
      "method": "POST",
      "path": "/v1/execute",
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "body": {
        "command": "sh -c \"echo 'default timeout ok'\"",
        "env": {},
        "files": {}
      }
    },
    "expected": {
      "status_code": 201,
      "output": {
        "duration": 10,
        "exit_code": 0,
        "id": "UUID",
        "stderr": "",
        "stdout": "default timeout ok\n",
        "timed_out": false
      }
    }
  },
  "final_stats_hidden": {
    "order": 7,
    "input": {
      "method": "GET",
      "path": "/v1/stats/execution"
    },
    "expected": {
      "status_code": 200,
      "output": {
        "duration": {
          "average": "{{ duration.average }}",
          "max": "{{ duration.max }}",
          "median": "{{ duration.median }}",
          "min": "{{ duration.min }}",
          "stddev": "{{ duration.stddev }}"
        },
        "ran": "{{ ran }}"
      }
    }
  },
  "env_and_files_together": {
    "order": 8,
    "input": {
      "method": "POST",
      "path": "/v1/execute",
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "body": {
        "command": "cat greeting.txt && echo $NAME",
        "env": {
          "NAME": "Alice"
        },
        "files": {
          "greeting.txt": "Hello from file"
        },
        "stdin": [],
        "timeout": 10
      }
    },
    "expected": {
      "status_code": 201,
      "output": {
        "duration": 10,
        "exit_code": 0,
        "id": "UUID",
        "stderr": "",
        "stdout": "HellofromfileAlice\n",
        "timed_out": false
      }
    }
  },
  "env_and_stdin_together": {
    "order": 9,
    "input": {
      "method": "POST",
      "path": "/v1/execute",
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "body": {
        "command": "read line\necho $PREFIX: $line",
        "env": {
          "PREFIX": "Input was"
        },
        "files": {},
        "stdin": [
          "test data"
        ],
        "timeout": 10
      }
    },
    "expected": {
      "status_code": 201,
      "output": {
        "duration": 10,
        "exit_code": 0,
        "id": "UUID",
        "stderr": "",
        "stdout": "Input was: test data\n",
        "timed_out": false
      }
    }
  },
  "files_and_stdin_together": {
    "order": 10,
    "input": {
      "method": "POST",
      "path": "/v1/execute",
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "body": {
        "command": "cat data.txt && cat",
        "env": {},
        "files": {
          "data.txt": "File content\n"
        },
        "stdin": "Stdin content\n",
        "timeout": 10
      }
    },
    "expected": {
      "status_code": 201,
      "output": {
        "duration": 10,
        "exit_code": 0,
        "id": "UUID",
        "stderr": "",
        "stdout": "File content\nStdin content\n",
        "timed_out": false
      }
    }
  },
  "timeout_with_env_and_files": {
    "order": 11,
    "input": {
      "method": "POST",
      "path": "/v1/execute",
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "body": {
        "command": "cat config.txt && echo $MODE && sleep 0.1",
        "env": {
          "MODE": "production"
        },
        "files": {
          "config.txt": "Config loaded"
        },
        "stdin": [],
        "timeout": 0.5
      }
    },
    "expected": {
      "status_code": 201,
      "output": {
        "duration": 10,
        "exit_code": 0,
        "id": "UUID",
        "stderr": "",
        "stdout": "Configloadedproduction",
        "timed_out": false
      }
    }
  },
  "all_features_combined": {
    "order": 12,
    "input": {
      "method": "POST",
      "path": "/v1/execute",
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "body": {
        "command": "cat config.txt && echo $USER && read input && echo Got: $input",
        "env": {
          "USER": "admin",
          "LANG": "en_US.UTF-8"
        },
        "files": {
          "config.txt": "System ready\n"
        },
        "stdin": [
          "user input"
        ],
        "timeout": 5
      }
    },
    "expected": {
      "status_code": 201,
      "output": {
        "duration": 10,
        "exit_code": 0,
        "id": "UUID",
        "stderr": "",
        "stdout": "System ready\nadmin\nGot: user input\n",
        "timed_out": false
      }
    }
  },
  "multiple_env_vars_multiple_files": {
    "order": 13,
    "input": {
      "method": "POST",
      "path": "/v1/execute",
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "body": {
        "command": "cat a.txt b.txt c.txt && echo $VAR1 $VAR2 $VAR3",
        "env": {
          "VAR1": "first",
          "VAR2": "second",
          "VAR3": "third"
        },
        "files": {
          "a.txt": "A",
          "b.txt": "B",
          "c.txt": "C"
        },
        "stdin": [],
        "timeout": 10
      }
    },
    "expected": {
      "status_code": 201,
      "output": {
        "duration": 10,
        "exit_code": 0,
        "id": "UUID",
        "stderr": "",
        "stdout": "ABCfirst second third\n",
        "timed_out": false
      }
    }
  },
  "stdin_array_with_files": {
    "order": 14,
    "input": {
      "method": "POST",
      "path": "/v1/execute",
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "body": {
        "command": "cat header.txt && while read line; do echo \"- $line\"; done",
        "env": {},
        "files": {
          "header.txt": "Items:\n"
        },
        "stdin": [
          "apple",
          "banana",
          "cherry"
        ],
        "timeout": 10
      }
    },
    "expected": {
      "status_code": 201,
      "output": {
        "duration": 10,
        "exit_code": 0,
        "id": "UUID",
        "stderr": "",
        "stdout": "Items:\n- apple\n- banana\n- cherry\n",
        "timed_out": false
      }
    }
  },
  "env_override_system": {
    "order": 15,
    "input": {
      "method": "POST",
      "path": "/v1/execute",
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "body": {
        "command": "echo $HOME && echo $PATH",
        "env": {
          "HOME": "/custom/home",
          "PATH": "/custom/bin"
        },
        "files": {},
        "stdin": [],
        "timeout": 10
      }
    },
    "expected": {
      "status_code": 201,
      "output": {
        "duration": 10,
        "exit_code": 0,
        "id": "UUID",
        "stderr": "",
        "stdout": "/custom/home\n/custom/bin\n",
        "timed_out": false
      }
    }
  },
  "very_small_timeout": {
    "order": 16,
    "input": {
      "method": "POST",
      "path": "/v1/execute",
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "body": {
        "command": "sleep 0.5",
        "env": {},
        "files": {},
        "stdin": [],
        "timeout": 0.02
      }
    },
    "expected": {
      "status_code": 201,
      "output": {
        "duration": 0.3,
        "exit_code": -1,
        "id": "UUID",
        "stderr": "",
        "stdout": "",
        "timed_out": true
      }
    }
  },
  "unicode_in_output": {
    "order": 17,
    "input": {
      "method": "POST",
      "path": "/v1/execute",
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "body": {
        "command": "printf 'ä½ å¥½ä¸–ç•Œ\\nðŸŽ‰âœ¨ðŸš€\\n'",
        "env": {},
        "files": {},
        "stdin": [],
        "timeout": 10
      }
    },
    "expected": {
      "status_code": 201,
      "output": {
        "duration": 10,
        "exit_code": 0,
        "id": "UUID",
        "stderr": "",
        "stdout": "ä½ å¥½ä¸–ç•Œ\nðŸŽ‰âœ¨ðŸš€\n",
        "timed_out": false
      }
    }
  },
  "very_long_stdout": {
    "order": 18,
    "input": {
      "method": "POST",
      "path": "/v1/execute",
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "body": {
        "command": "for i in $(seq 1 100); do echo \"Line $i\"; done",
        "env": {},
        "files": {},
        "stdin": [],
        "timeout": 10
      }
    },
    "expected": {
      "status_code": 201,
      "output": {
        "duration": 10,
        "exit_code": 0,
        "id": "UUID",
        "stderr": "",
        "stdout": "Line 1\nLine 2\nLine 3\nLine 4\nLine 5\nLine 6\nLine 7\nLine 8\nLine 9\nLine 10\nLine 11\nLine 12\nLine 13\nLine 14\nLine 15\nLine 16\nLine 17\nLine 18\nLine 19\nLine 20\nLine 21\nLine 22\nLine 23\nLine 24\nLine 25\nLine 26\nLine 27\nLine 28\nLine 29\nLine 30\nLine 31\nLine 32\nLine 33\nLine 34\nLine 35\nLine 36\nLine 37\nLine 38\nLine 39\nLine 40\nLine 41\nLine 42\nLine 43\nLine 44\nLine 45\nLine 46\nLine 47\nLine 48\nLine 49\nLine 50\nLine 51\nLine 52\nLine 53\nLine 54\nLine 55\nLine 56\nLine 57\nLine 58\nLine 59\nLine 60\nLine 61\nLine 62\nLine 63\nLine 64\nLine 65\nLine 66\nLine 67\nLine 68\nLine 69\nLine 70\nLine 71\nLine 72\nLine 73\nLine 74\nLine 75\nLine 76\nLine 77\nLine 78\nLine 79\nLine 80\nLine 81\nLine 82\nLine 83\nLine 84\nLine 85\nLine 86\nLine 87\nLine 88\nLine 89\nLine 90\nLine 91\nLine 92\nLine 93\nLine 94\nLine 95\nLine 96\nLine 97\nLine 98\nLine 99\nLine 100\n",
        "timed_out": false
      }
    }
  },
  "exit_code_variations": {
    "order": 19,
    "input": {
      "method": "POST",
      "path": "/v1/execute",
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "body": {
        "command": "exit 127",
        "env": {},
        "files": {},
        "stdin": [],
        "timeout": 10
      }
    },
    "expected": {
      "status_code": 201,
      "output": {
        "duration": 10,
        "exit_code": 127,
        "id": "UUID",
        "stderr": "",
        "stdout": "",
        "timed_out": false
      }
    }
  },
  "command_with_shell_metacharacters": {
    "order": 20,
    "input": {
      "method": "POST",
      "path": "/v1/execute",
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "body": {
        "command": "echo 'hello' | tr 'h' 'H' && echo 'world' > /tmp/out.txt && cat /tmp/out.txt",
        "env": {},
        "files": {},
        "stdin": [],
        "timeout": 10
      }
    },
    "expected": {
      "status_code": 201,
      "output": {
        "duration": 10,
        "exit_code": 0,
        "id": "UUID",
        "stderr": "",
        "stdout": "Hello\nworld\n",
        "timed_out": false
      }
    }
  }
}