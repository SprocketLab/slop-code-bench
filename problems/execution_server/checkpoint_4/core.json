{
  "backward_compatible_string": {
    "expected": {
      "output": {
        "duration": 10,
        "exit_code": 0,
        "files": {},
        "id": "UUID",
        "stderr": "",
        "stdout": "hello world\n",
        "timed_out": false
      },
      "status_code": 201
    },
    "input": {
      "body": {
        "command": "echo 'hello world'"
      },
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "method": "POST",
      "path": "/v1/execute"
    },
    "order": 1
  },
  "chain_continue_on_error": {
    "expected": {
      "output": {
        "commands": [
          {
            "cmd": "echo 'test 1' && exit 1",
            "duration": 10,
            "exit_code": 1,
            "stderr": "",
            "stdout": "test 1\n",
            "timed_out": false
          },
          {
            "cmd": "echo 'test 2' && exit 0",
            "duration": 10,
            "exit_code": 0,
            "stderr": "",
            "stdout": "test 2\n",
            "timed_out": false
          },
          {
            "cmd": "echo 'test 3' && exit 1",
            "duration": 10,
            "exit_code": 1,
            "stderr": "",
            "stdout": "test 3\n",
            "timed_out": false
          }
        ],
        "duration": 10,
        "exit_code": 1,
        "files": {},
        "id": "UUID",
        "timed_out": false
      },
      "status_code": 201
    },
    "input": {
      "body": {
        "command": [
          {
            "cmd": "echo 'test 1' && exit 1"
          },
          {
            "cmd": "echo 'test 2' && exit 0"
          },
          {
            "cmd": "echo 'test 3' && exit 1"
          }
        ],
        "continue_on_error": true
      },
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "method": "POST",
      "path": "/v1/execute"
    },
    "order": 4
  },
  "chain_per_command_timeout": {
    "expected": {
      "output": {
        "commands": [
          {
            "cmd": "echo fast",
            "duration": 10,
            "exit_code": 0,
            "stderr": "",
            "stdout": "fast\n",
            "timed_out": false
          },
          {
            "cmd": "sleep 5",
            "duration": 1.500,
            "exit_code": -1,
            "stderr": "",
            "stdout": "",
            "timed_out": true
          },
          {
            "cmd": "echo 'never runs'",
            "duration": 10,
            "exit_code": 0,
            "required": true,
            "stderr": "",
            "stdout": "never runs\n",
            "timed_out": false
          }
        ],
        "duration": 10,
        "exit_code": -1,
        "files": {},
        "id": "UUID",
        "timed_out": true
      },
      "status_code": 201
    },
    "input": {
      "body": {
        "command": [
          {
            "cmd": "echo fast"
          },
          {
            "cmd": "sleep 5",
            "timeout": 1
          },
          {
            "cmd": "echo 'never runs'",
            "required": true
          }
        ],
        "timeout": 10
      },
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "method": "POST",
      "path": "/v1/execute"
    },
    "order": 5
  },
  "chain_required_runs": {
    "expected": {
      "output": {
        "commands": [
          {
            "cmd": "sh -c 'echo build > artifact.txt'",
            "duration": 10,
            "exit_code": 0,
            "stderr": "",
            "stdout": "",
            "timed_out": false
          },
          {
            "cmd": "sh -c 'cat nope.txt'",
            "duration": 10,
            "exit_code": 1,
            "stderr": "cat: nope.txt: No such file or directory\n",
            "stdout": "",
            "timed_out": false
          },
          {
            "cmd": "sh -c 'echo cleanup >> artifact.txt'",
            "duration": 10,
            "exit_code": 0,
            "required": true,
            "stderr": "",
            "stdout": "",
            "timed_out": false
          }
        ],
        "duration": 10,
        "exit_code": 1,
        "files": {
          "artifact.txt": "build\ncleanup\n"
        },
        "id": "UUID",
        "timed_out": false
      },
      "status_code": 201
    },
    "input": {
      "body": {
        "command": [
          {
            "cmd": "sh -c 'echo build > artifact.txt'"
          },
          {
            "cmd": "sh -c 'cat nope.txt'"
          },
          {
            "cmd": "sh -c 'echo cleanup >> artifact.txt'",
            "required": true
          }
        ],
        "track": [
          "*.txt"
        ]
      },
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "method": "POST",
      "path": "/v1/execute"
    },
    "order": 3
  },
  "chain_stop_on_failure": {
    "expected": {
      "output": {
        "commands": [
          {
            "cmd": "echo 'step 1' && exit 0",
            "duration": 10,
            "exit_code": 0,
            "stderr": "",
            "stdout": "step 1\n",
            "timed_out": false
          },
          {
            "cmd": "echo 'step 2' && exit 1",
            "duration": 10,
            "exit_code": 1,
            "stderr": "",
            "stdout": "step 2\n",
            "timed_out": false
          }
        ],
        "duration": 10,
        "exit_code": 1,
        "files": {},
        "id": "UUID",
        "timed_out": false
      },
      "status_code": 201
    },
    "input": {
      "body": {
        "command": [
          {
            "cmd": "echo 'step 1' && exit 0"
          },
          {
            "cmd": "echo 'step 2' && exit 1"
          },
          {
            "cmd": "echo 'step 3'"
          }
        ]
      },
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "method": "POST",
      "path": "/v1/execute"
    },
    "order": 2
  },
  "all_commands_succeed": {
    "expected": {
      "output": {
        "commands": [
          {
            "cmd": "echo 'step 1'",
            "duration": 10,
            "exit_code": 0,
            "stderr": "",
            "stdout": "step 1\n",
            "timed_out": false
          },
          {
            "cmd": "echo 'step 2'",
            "duration": 10,
            "exit_code": 0,
            "stderr": "",
            "stdout": "step 2\n",
            "timed_out": false
          },
          {
            "cmd": "echo 'step 3'",
            "duration": 10,
            "exit_code": 0,
            "stderr": "",
            "stdout": "step 3\n",
            "timed_out": false
          }
        ],
        "duration": 10,
        "exit_code": 0,
        "files": {},
        "id": "UUID",
        "timed_out": false
      },
      "status_code": 201
    },
    "input": {
      "body": {
        "command": [
          {
            "cmd": "echo 'step 1'"
          },
          {
            "cmd": "echo 'step 2'"
          },
          {
            "cmd": "echo 'step 3'"
          }
        ]
      },
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "method": "POST",
      "path": "/v1/execute"
    },
    "order": 6
  },
  "single_command_array": {
    "expected": {
      "output": {
        "commands": [
          {
            "cmd": "echo 'single'",
            "duration": 10,
            "exit_code": 0,
            "stderr": "",
            "stdout": "single\n",
            "timed_out": false
          }
        ],
        "duration": 10,
        "exit_code": 0,
        "files": {},
        "id": "UUID",
        "timed_out": false
      },
      "status_code": 201
    },
    "input": {
      "body": {
        "command": [
          {
            "cmd": "echo 'single'"
          }
        ]
      },
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "method": "POST",
      "path": "/v1/execute"
    },
    "order": 7
  },
  "multiple_required_commands": {
    "expected": {
      "output": {
        "commands": [
          {
            "cmd": "echo 'start'",
            "duration": 10,
            "exit_code": 0,
            "required": true,
            "stderr": "",
            "stdout": "start\n",
            "timed_out": false
          },
          {
            "cmd": "exit 1",
            "duration": 10,
            "exit_code": 1,
            "stderr": "",
            "stdout": "",
            "timed_out": false
          },
          {
            "cmd": "echo 'cleanup'",
            "duration": 10,
            "exit_code": 0,
            "required": true,
            "stderr": "",
            "stdout": "cleanup\n",
            "timed_out": false
          }
        ],
        "duration": 10,
        "exit_code": 1,
        "files": {},
        "id": "UUID",
        "timed_out": false
      },
      "status_code": 201
    },
    "input": {
      "body": {
        "command": [
          {
            "cmd": "echo 'start'",
            "required": true
          },
          {
            "cmd": "exit 1"
          },
          {
            "cmd": "echo 'cleanup'",
            "required": true
          }
        ]
      },
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "method": "POST",
      "path": "/v1/execute"
    },
    "order": 8
  },
  "chain_with_env_vars": {
    "expected": {
      "output": {
        "commands": [
          {
            "cmd": "sh -c 'echo $MY_VAR'",
            "duration": 10,
            "exit_code": 0,
            "stderr": "",
            "stdout": "test_value\n",
            "timed_out": false
          },
          {
            "cmd": "sh -c 'echo $MY_VAR-$MY_VAR'",
            "duration": 10,
            "exit_code": 0,
            "stderr": "",
            "stdout": "test_value-test_value\n",
            "timed_out": false
          }
        ],
        "duration": 10,
        "exit_code": 0,
        "files": {},
        "id": "UUID",
        "timed_out": false
      },
      "status_code": 201
    },
    "input": {
      "body": {
        "command": [
          {
            "cmd": "sh -c 'echo $MY_VAR'"
          },
          {
            "cmd": "sh -c 'echo $MY_VAR-$MY_VAR'"
          }
        ],
        "env": {
          "MY_VAR": "test_value"
        }
      },
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "method": "POST",
      "path": "/v1/execute"
    },
    "order": 9
  },
  "chain_with_input_files": {
    "expected": {
      "output": {
        "commands": [
          {
            "cmd": "cat input.txt",
            "duration": 10,
            "exit_code": 0,
            "stderr": "",
            "stdout": "file content\n",
            "timed_out": false
          },
          {
            "cmd": "wc -l input.txt",
            "duration": 10,
            "exit_code": 0,
            "stderr": "",
            "stdout": "1 input.txt\n",
            "timed_out": false
          }
        ],
        "duration": 10,
        "exit_code": 0,
        "files": {},
        "id": "UUID",
        "timed_out": false
      },
      "status_code": 201
    },
    "input": {
      "body": {
        "command": [
          {
            "cmd": "cat input.txt"
          },
          {
            "cmd": "wc -l input.txt"
          }
        ],
        "files": {
          "input.txt": "file content\n"
        }
      },
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "method": "POST",
      "path": "/v1/execute"
    },
    "order": 10
  },
  "long_command_chain": {
    "expected": {
      "output": {
        "commands": [
          {
            "cmd": "echo 'cmd1'",
            "duration": 10,
            "exit_code": 0,
            "stderr": "",
            "stdout": "cmd1\n",
            "timed_out": false
          },
          {
            "cmd": "echo 'cmd2'",
            "duration": 10,
            "exit_code": 0,
            "stderr": "",
            "stdout": "cmd2\n",
            "timed_out": false
          },
          {
            "cmd": "echo 'cmd3'",
            "duration": 10,
            "exit_code": 0,
            "stderr": "",
            "stdout": "cmd3\n",
            "timed_out": false
          },
          {
            "cmd": "echo 'cmd4'",
            "duration": 10,
            "exit_code": 0,
            "stderr": "",
            "stdout": "cmd4\n",
            "timed_out": false
          },
          {
            "cmd": "echo 'cmd5'",
            "duration": 10,
            "exit_code": 0,
            "stderr": "",
            "stdout": "cmd5\n",
            "timed_out": false
          }
        ],
        "duration": 10,
        "exit_code": 0,
        "files": {},
        "id": "UUID",
        "timed_out": false
      },
      "status_code": 201
    },
    "input": {
      "body": {
        "command": [
          {
            "cmd": "echo 'cmd1'"
          },
          {
            "cmd": "echo 'cmd2'"
          },
          {
            "cmd": "echo 'cmd3'"
          },
          {
            "cmd": "echo 'cmd4'"
          },
          {
            "cmd": "echo 'cmd5'"
          }
        ]
      },
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "method": "POST",
      "path": "/v1/execute"
    },
    "order": 11
  },
  "required_command_fails": {
    "expected": {
      "output": {
        "commands": [
          {
            "cmd": "echo 'normal'",
            "duration": 10,
            "exit_code": 0,
            "stderr": "",
            "stdout": "normal\n",
            "timed_out": false
          },
          {
            "cmd": "exit 5",
            "duration": 10,
            "exit_code": 5,
            "required": true,
            "stderr": "",
            "stdout": "",
            "timed_out": false
          }
        ],
        "duration": 10,
        "exit_code": 5,
        "files": {},
        "id": "UUID",
        "timed_out": false
      },
      "status_code": 201
    },
    "input": {
      "body": {
        "command": [
          {
            "cmd": "echo 'normal'"
          },
          {
            "cmd": "exit 5",
            "required": true
          }
        ]
      },
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "method": "POST",
      "path": "/v1/execute"
    },
    "order": 12
  },
  "multiple_failures": {
    "expected": {
      "output": {
        "commands": [
          {
            "cmd": "exit 2",
            "duration": 10,
            "exit_code": 2,
            "stderr": "",
            "stdout": "",
            "timed_out": false
          }
        ],
        "duration": 10,
        "exit_code": 2,
        "files": {},
        "id": "UUID",
        "timed_out": false
      },
      "status_code": 201
    },
    "input": {
      "body": {
        "command": [
          {
            "cmd": "exit 2"
          },
          {
            "cmd": "exit 3"
          },
          {
            "cmd": "exit 4"
          }
        ]
      },
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "method": "POST",
      "path": "/v1/execute"
    },
    "order": 13
  },
  "working_directory_persistence": {
    "expected": {
      "output": {
        "commands": [
          {
            "cmd": "mkdir testdir",
            "duration": 10,
            "exit_code": 0,
            "stderr": "",
            "stdout": "",
            "timed_out": false
          },
          {
            "cmd": "cd testdir && mkdir subdir",
            "duration": 10,
            "exit_code": 0,
            "stderr": "",
            "stdout": "",
            "timed_out": false
          },
          {
            "cmd": "sh -c 'echo data > testdir/subdir/file.txt'",
            "duration": 10,
            "exit_code": 0,
            "stderr": "",
            "stdout": "",
            "timed_out": false
          },
          {
            "cmd": "cat testdir/subdir/file.txt",
            "duration": 10,
            "exit_code": 0,
            "stderr": "",
            "stdout": "data\n",
            "timed_out": false
          }
        ],
        "duration": 10,
        "exit_code": 0,
        "files": {
          "testdir/subdir/file.txt": "data\n"
        },
        "id": "UUID",
        "timed_out": false
      },
      "status_code": 201
    },
    "input": {
      "body": {
        "command": [
          {
            "cmd": "mkdir testdir"
          },
          {
            "cmd": "cd testdir && mkdir subdir"
          },
          {
            "cmd": "sh -c 'echo data > testdir/subdir/file.txt'"
          },
          {
            "cmd": "cat testdir/subdir/file.txt"
          }
        ],
        "track": [
          "**/*.txt"
        ]
      },
      "headers": {
        "content-type": "application/json; charset=utf-8"
      },
      "method": "POST",
      "path": "/v1/execute"
    },
    "order": 14
  },
  "final_stats": {
    "expected": {
      "output": {
        "commands": {
          "average": "{{ commands.average }}",
          "average_ran": "{{ commands.average_ran }}",
          "duration": {
            "average": "{{ commands.duration.average }}",
            "max": "{{ commands.duration.max }}",
            "median": "{{ commands.duration.median }}",
            "min": "{{ commands.duration.min }}",
            "stddev": "{{ commands.duration.stddev }}"
          },
          "ran": "{{ commands.ran }}",
          "total": "{{ commands.total }}"
        },
        "duration": {
          "average": "{{ duration.average }}",
          "max": "{{ duration.max }}",
          "median": "{{ duration.median }}",
          "min": "{{ duration.min }}",
          "stddev": "{{ duration.stddev }}"
        },
        "ran": "{{ ran }}"
      },
      "status_code": 200
    },
    "input": {
      "method": "GET",
      "path": "/v1/stats/execution"
    },
    "order": 16
  },
  "initial_stats": {
    "expected": {
      "output": {
        "commands": {
          "total": 0,
          "ran": 0,
          "average": null,
          "average_ran": null,
          "duration": {
            "average": null,
            "max": null,
            "median": null,
            "min": null,
            "stddev": null
          }
        },
        "duration": {
          "average": null,
          "max": null,
          "median": null,
          "min": null,
          "stddev": null
        },
        "ran": 0
      },
      "status_code": 200
    },
    "input": {
      "method": "GET",
      "path": "/v1/stats/execution"
    },
    "order": 0
  }
}